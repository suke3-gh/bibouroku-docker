# bibouroku-docker > postgresql-configs

文書作成日:西暦2023年6月29日 最終更新日:西暦2023年7月19日

Docker上でPostgreSQLを動作させる過程で苦労した点と、それに対する解決策を書き留める。

1. [データベースの保存先](#データベースの保存先)
2. [マウントすべきディレクトリ](#マウントすべきディレクトリ)
3. [参考文献](#参考文献)

## データベースの保存先
データベースの内容はコンテナの`/var/lib/postgres/data/base/`に保存されている。このディレクトリには数字のみで命名されているディレクトリがあり、`1`, `13394`, `13395`, `16384`はログインすることで作成されるようだ。新たに作成したデータベースには `16385` から順に番号が振られたディレクトリが用意されていた。

## マウントすべきディレクトリ
Postgresコンテナにおいて、データ保存先のパスは`/var/lib/postgresql/data/`のようだ。これをコンテナ側のマウント先としてボリュームに指定することでデータの保持が可能になった。

「volumesの記述例」
```
volumes: ./postgres/data/:/var/lib/postgresql/data/
```

環境を移行する時など、初めてログインする時に`/var/lib/postgresql/data/`をマウントしているとパスワードが設定されずログインができなくなる。これはホスト側の`/postgres/data/`に予めディレクトリを用意している時に起こるようで、このディレクトリを削除してコンテナを再起動すればログインできるようになる。

## 参考文献
1. https://hub.docker.com/_/postgres (postgres - Docker Hub)
